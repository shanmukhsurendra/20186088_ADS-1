We can do better algorithm by making some improvements for quick union which is known as Weighted quick union. Here  in weighted  quick union, initially we will have weights for all roots as 1 then as per changes in roots, we add different weights and finally we will calculate total no of many trees. Here we link smaller tree link to larger tree. Difference between Quick and weighted quick union is we have tall trees in quick union.  There are  Find and Union in weighted quick union analysis, where Find means it is the time proportional to depth of p and q. Union means it takes constant time, gives roots. Preposition means  it is depth of any node x is at most log N.  Here for algorithm of Weighted Quick Union, initialization will be N, union and connected will be log N.  Even its performance can be improved  by idea of Path compression. Here nodes were divided and connected to roots. By doing this we can completely  keep the tree flat. In theory Weighted quick union with path compression is not quite linear and in practice it is linear.